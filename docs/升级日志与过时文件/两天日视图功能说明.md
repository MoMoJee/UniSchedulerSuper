# 两天日视图功能说明

## 功能概述
将原有的单天日视图升级为两天日视图，在日历中并排显示连续两天的日程安排。

## 实现方式

### 1. 自定义 FullCalendar 视图
使用 FullCalendar 的自定义视图功能创建 `timeGridTwoDay` 视图：

```javascript
views: {
    timeGridTwoDay: {
        type: 'timeGrid',          // 基于时间网格视图
        duration: { days: 2 },     // 显示2天
        dateIncrement: { days: 1 }, // 每次前进/后退1天
        buttonText: '2日'           // 按钮文本
    }
}
```

**关键配置说明**：
- `duration: { days: 2 }` - 视图显示范围为2天
- `dateIncrement: { days: 1 }` - 点击 "<" ">" 按钮时，每次只移动1天，而不是默认的2天

### 2. 工具栏按钮调整
原有按钮配置：
```javascript
headerToolbar: {
    right: 'timeGridDay,dayGridMonth,timeGridWeek,listWeek'
}
```

新按钮配置：
```javascript
headerToolbar: {
    right: 'timeGridTwoDay,dayGridMonth,timeGridWeek,listWeek'
}
```

将原来的 `timeGridDay`（单天日视图）替换为 `timeGridTwoDay`（两天日视图）。

### 3. 视图特性
- **布局**：竖列式排列，左列显示当天，右列显示次日
- **时间范围**：00:00-24:00（完整24小时）
- **滚动行为**：自动滚动到早上8点
- **全天事件槽**：限制高度为50px，避免占用过多空间
- **可编辑性**：支持拖拽、调整大小等所有原有功能

### 4. 兼容性
该视图与现有功能完全兼容：
- ✅ 事件拖拽和调整大小
- ✅ 点击空白时间创建事件
- ✅ 点击事件编辑
- ✅ 重复事件显示
- ✅ 提醒功能
- ✅ 全天事件显示

## 修改文件清单

### 核心文件
1. **staticfiles/js/event-manager.js**（浏览器加载文件）
   - 添加 `views` 配置
   - 修改 `headerToolbar` 按钮
   
2. **core/static/js/event-manager.js**（源文件）
   - 与 staticfiles 版本保持一致

3. **core/templates/home_new.html**
   - 更新版本号：v=20251030-002

## 使用说明

### 切换到两天日视图
1. 刷新浏览器页面（Ctrl+F5 硬刷新）
2. 点击日历右上角的 **"2日"** 按钮
3. 日历将显示今天和明天的日程

### 视图操作
- **左右滑动**：使用鼠标拖拽或触控板滑动查看不同日期
- **创建事件**：点击空白时间段或拖拽选择时间范围
- **编辑事件**：点击已有事件
- **拖拽事件**：在两天之间拖动事件可快速调整日期

## 技术优势

### 1. 原生支持
使用 FullCalendar 内置的自定义视图 API，无需额外依赖或复杂改造。

### 2. 灵活配置
可轻松调整为显示更多天数，例如：
```javascript
views: {
    timeGridThreeDay: {
        type: 'timeGrid',
        duration: { days: 3 },  // 显示3天
        buttonText: '3日'
    }
}
```

### 3. 一致体验
继承了所有 timeGrid 视图的特性和交互逻辑，用户体验统一。

## 后续优化建议

### 可选增强功能
1. **智能日期显示**
   - 添加日期标题，显示"今天 / 明天"或具体日期
   - 高亮当前日期列

2. **移动端优化**
   - 在小屏幕上可考虑折叠为单天视图
   - 添加左右滑动切换手势

3. **用户偏好保存**
   - 记住用户最后使用的视图类型
   - 支持设置默认视图

## 版本信息
- **实施日期**：2025年10月30日
- **最后更新**：2025年10月31日（添加 dateIncrement 配置）
- **版本号**：v20251031-001
- **涉及模块**：事件管理器 (event-manager.js)

## 更新日志

### v20251031-001 (2025-10-31)
- 添加 `dateIncrement: { days: 1 }` 配置
- 修复：点击 "<" ">" 按钮时，从跳2天改为跳1天
- 提升用户体验：更精细的日期导航控制

### v20251030-002 (2025-10-30)
- 初始版本：实现两天日视图功能
- 添加自定义 `timeGridTwoDay` 视图
- 替换原有的单天日视图
