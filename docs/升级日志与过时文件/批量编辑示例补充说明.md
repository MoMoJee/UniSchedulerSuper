# æ‰¹é‡ç¼–è¾‘ç¤ºä¾‹è¡¥å……è¯´æ˜

> **æ›´æ–°æ—¥æœŸ**: 2025-01-XX  
> **æ›´æ–°å†…å®¹**: ä¸º Reminders API æ·»åŠ å®Œæ•´çš„ bulk-edit æ‰¹é‡ç¼–è¾‘ç¤ºä¾‹  
> **å½±å“æ–‡ä»¶**: `api_examples/example_reminders_api.py`, `test_bulk_edit_reminders.py`, æ–‡æ¡£

---

## ğŸ“‹ æ›´æ–°å†…å®¹

### 1. æ–°å¢ç¤ºä¾‹å‡½æ•°

åœ¨ `api_examples/example_reminders_api.py` ä¸­æ–°å¢äº† 6 ä¸ªæ‰¹é‡ç¼–è¾‘ç¤ºä¾‹å‡½æ•°ï¼š

#### ç¤ºä¾‹ 9A: `example_bulk_edit_single_instance()`
**åŠŸèƒ½**: ç¼–è¾‘å•ä¸ªé‡å¤æé†’å®ä¾‹ï¼ˆä»ç³»åˆ—ä¸­ç‹¬ç«‹ï¼‰

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: ç›®æ ‡å®ä¾‹ID
- `series_id`: ç³»åˆ—ID

**ç”¨é€”**: å°†æŸä¸ªé‡å¤å®ä¾‹ç‹¬ç«‹å‡ºæ¥å•ç‹¬ç¼–è¾‘ï¼Œä¸å½±å“ç³»åˆ—å…¶ä»–å®ä¾‹

**ç¤ºä¾‹**:
```python
example_bulk_edit_single_instance(token, "reminder-123", "series-456")
```

---

#### ç¤ºä¾‹ 9B: `example_bulk_edit_all_series()`
**åŠŸèƒ½**: ç¼–è¾‘æ•´ä¸ªé‡å¤ç³»åˆ—çš„æ‰€æœ‰å®ä¾‹

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: ç³»åˆ—ä¸­ä»»ä¸€æé†’ID
- `series_id`: ç³»åˆ—ID

**ç”¨é€”**: æ‰¹é‡æ›´æ–°ç³»åˆ—æ‰€æœ‰å®ä¾‹çš„å­—æ®µï¼ˆä¸ä¿®æ”¹è§¦å‘æ—¶é—´ï¼‰

**ç¤ºä¾‹**:
```python
example_bulk_edit_all_series(token, "reminder-123", "series-456")
```

---

#### ç¤ºä¾‹ 9C: `example_bulk_edit_from_this()`
**åŠŸèƒ½**: ä»æŒ‡å®šå®ä¾‹å¼€å§‹ç¼–è¾‘è¯¥å®ä¾‹åŠä¹‹åçš„æ‰€æœ‰å®ä¾‹

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: èµ·å§‹å®ä¾‹ID
- `series_id`: ç³»åˆ—ID

**ç”¨é€”**: ä»æŸä¸ªæ—¶é—´ç‚¹å¼€å§‹æ›´æ–°ï¼Œä¹‹å‰çš„å®ä¾‹ä¿æŒä¸å˜

**ç¤ºä¾‹**:
```python
example_bulk_edit_from_this(token, "reminder-123", "series-456")
```

---

#### ç¤ºä¾‹ 9D: `example_bulk_change_rrule()`
**åŠŸèƒ½**: ä¿®æ”¹é‡å¤è§„åˆ™ï¼Œåˆ›å»ºæ–°ç³»åˆ—

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: ç›®æ ‡å®ä¾‹ID
- `series_id`: ç³»åˆ—ID
- `from_time`: èµ·å§‹æ—¶é—´ï¼ˆISOæ ¼å¼ï¼‰

**ç”¨é€”**: ä»æŒ‡å®šæ—¶é—´å¼€å§‹æ”¹å˜é‡å¤è§„å¾‹ï¼ˆå¦‚ä»æ¯å¤©æ”¹ä¸ºæ¯å‘¨ï¼‰

**ç¤ºä¾‹**:
```python
example_bulk_change_rrule(
    token, 
    "reminder-123", 
    "series-456", 
    "2025-01-25T10:00:00"
)
```

---

#### ç¤ºä¾‹ 9E: `example_bulk_delete_all_series()`
**åŠŸèƒ½**: åˆ é™¤æ•´ä¸ªé‡å¤ç³»åˆ—

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: ç³»åˆ—ä¸­ä»»ä¸€æé†’ID
- `series_id`: ç³»åˆ—ID

**ç”¨é€”**: å½»åº•åˆ é™¤æ•´ä¸ªé‡å¤æé†’ç³»åˆ—

**ç¤ºä¾‹**:
```python
example_bulk_delete_all_series(token, "reminder-123", "series-456")
```

---

#### ç¤ºä¾‹ 9F: `example_bulk_delete_from_this()`
**åŠŸèƒ½**: åˆ é™¤æŒ‡å®šå®ä¾‹åŠä¹‹åçš„æ‰€æœ‰å®ä¾‹

**å‚æ•°**:
- `token`: è®¤è¯ Token
- `reminder_id`: èµ·å§‹å®ä¾‹ID
- `series_id`: ç³»åˆ—ID

**ç”¨é€”**: æˆªæ–­ç³»åˆ—ï¼Œä¿ç•™ä¹‹å‰çš„å®ä¾‹

**ç¤ºä¾‹**:
```python
example_bulk_delete_from_this(token, "reminder-123", "series-456")
```

---

### 2. æ–°å¢ç»¼åˆç¤ºä¾‹

#### ç¤ºä¾‹ 13: `example_bulk_edit_workflow()`
**åŠŸèƒ½**: æ‰¹é‡ç¼–è¾‘å·¥ä½œæµç¨‹ç»¼åˆæ¼”ç¤º

**å†…å®¹**:
- è¯´æ˜æ‰€æœ‰æ‰¹é‡ç¼–è¾‘åœºæ™¯
- æä¾›å®Œæ•´çš„ä½¿ç”¨æŒ‡å—
- åŒ…å«ä»£ç ç¤ºä¾‹

**ç‰¹ç‚¹**:
- ğŸ“ è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜
- ğŸ“‹ ç¤ºä¾‹ä»£ç ç‰‡æ®µ
- ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

---

### 3. æ–°å¢æµ‹è¯•è„šæœ¬

#### `test_bulk_edit_reminders.py`
**åŠŸèƒ½**: æ‰¹é‡ç¼–è¾‘åŠŸèƒ½çš„å®Œæ•´å®æˆ˜æ¼”ç¤º

**æµ‹è¯•æµç¨‹**:

1. **æ­¥éª¤1**: åˆ›å»ºé‡å¤æé†’ï¼ˆæ¯å¤©ï¼Œå…±10æ¬¡ï¼‰
2. **æ­¥éª¤2**: è·å–æé†’IDå’Œç³»åˆ—ID
3. **æ­¥éª¤3**: ç¼–è¾‘æ•´ä¸ªç³»åˆ—ï¼ˆä¿®æ”¹æ ‡é¢˜å’Œä¼˜å…ˆçº§ï¼‰
4. **æ­¥éª¤4**: éªŒè¯ä¿®æ”¹ç»“æœ
5. **æ­¥éª¤5**: ä»ç¬¬5ä¸ªå®ä¾‹å¼€å§‹ç¼–è¾‘
6. **æ­¥éª¤6**: ä¿®æ”¹é‡å¤è§„åˆ™ï¼ˆä»æ¯å¤©æ”¹ä¸ºæ¯å‘¨ï¼‰
7. **æ­¥éª¤7**: æ¸…ç†æµ‹è¯•æ•°æ®

**ä½¿ç”¨æ–¹æ³•**:
```bash
python test_bulk_edit_reminders.py
```

**è¾“å‡ºç¤ºä¾‹**:
```
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª
æ‰¹é‡ç¼–è¾‘é‡å¤æé†’ - å®æˆ˜æ¼”ç¤º
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª

ğŸ” è·å– Token...
âœ… Token è·å–æˆåŠŸ

============================================================
ğŸ“‹ æ­¥éª¤ 1: åˆ›å»ºé‡å¤æé†’ï¼ˆæ¯å¤©ï¼Œå…±10æ¬¡ï¼‰
============================================================
åˆ›å»ºæ—¶é—´: 2025-01-21T09:00:00
é‡å¤è§„åˆ™: æ¯å¤©é‡å¤ï¼Œå…±10æ¬¡
âœ… åˆ›å»ºæˆåŠŸ: é‡å¤æé†’å·²åˆ›å»ºï¼Œç³»åˆ—ID: xxx

============================================================
ğŸ” æ­¥éª¤ 2: è·å–æé†’åˆ—è¡¨å¹¶æ‰¾åˆ°æµ‹è¯•æé†’
============================================================
âœ… æ‰¾åˆ°æµ‹è¯•æé†’:
   ID: reminder-xxx
   ç³»åˆ—ID: series-xxx
   è§¦å‘æ—¶é—´: 2025-01-21T09:00:00
   é‡å¤è§„åˆ™: FREQ=DAILY;INTERVAL=1;COUNT=10
   å½“å‰å®ä¾‹æ•°: 10

...ï¼ˆå…¶ä»–æ­¥éª¤ï¼‰...

============================================================
âœ… æ‰¹é‡ç¼–è¾‘æµ‹è¯•å®Œæˆï¼
============================================================

ğŸ’¡ æµ‹è¯•æ€»ç»“:
  âœ… åˆ›å»ºé‡å¤æé†’
  âœ… ç¼–è¾‘æ•´ä¸ªç³»åˆ—ï¼ˆä¿®æ”¹æ‰€æœ‰å®ä¾‹ï¼‰
  âœ… ä»æŸå®ä¾‹å¼€å§‹ç¼–è¾‘
  âœ… ä¿®æ”¹é‡å¤è§„åˆ™ï¼ˆåˆ›å»ºæ–°ç³»åˆ—ï¼‰
  âœ… åˆ é™¤æµ‹è¯•æ•°æ®

ğŸ‰ æ‰€æœ‰æ‰¹é‡ç¼–è¾‘åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯å¯¹ç…§è¡¨

| åœºæ™¯ | ä½¿ç”¨å‡½æ•° | edit_scope | è¯´æ˜ |
|------|---------|-----------|------|
| ä¿®æ”¹å•ä¸ªå®ä¾‹ | `example_bulk_edit_single_instance()` | `this_only` | ç‹¬ç«‹å‡ºæ¥å•ç‹¬ç¼–è¾‘ |
| ä¿®æ”¹æ‰€æœ‰å®ä¾‹ | `example_bulk_edit_all_series()` | `all` | æ‰¹é‡æ›´æ–°æ‰€æœ‰å®ä¾‹ |
| ä»æŸå¤„å¼€å§‹ä¿®æ”¹ | `example_bulk_edit_from_this()` | `from_this` | ä¿®æ”¹æ­¤åŠä¹‹åå®ä¾‹ |
| æ”¹å˜é‡å¤è§„å¾‹ | `example_bulk_change_rrule()` | `from_time` | åˆ›å»ºæ–°ç³»åˆ— |
| åˆ é™¤æ•´ä¸ªç³»åˆ— | `example_bulk_delete_all_series()` | `all` | å½»åº•åˆ é™¤ |
| æˆªæ–­ç³»åˆ— | `example_bulk_delete_from_this()` | `from_this` | ä¿ç•™ä¹‹å‰å®ä¾‹ |

---

## ğŸ“ API å‚æ•°è¯¦è§£

### ç¼–è¾‘æ“ä½œ (operation: "edit")

#### edit_scope: "this_only" (å•ä¸ªå®ä¾‹)
```json
{
    "operation": "edit",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "this_only",
    "title": "æ–°æ ‡é¢˜",
    "content": "æ–°å†…å®¹",
    "priority": "high"
}
```

**æ•ˆæœ**: 
- å°†è¯¥å®ä¾‹ä»ç³»åˆ—ä¸­ç‹¬ç«‹å‡ºæ¥
- æˆä¸ºå•ç‹¬çš„æé†’ï¼ˆä¸å†é‡å¤ï¼‰
- ä¸å½±å“ç³»åˆ—å…¶ä»–å®ä¾‹

---

#### edit_scope: "all" (æ•´ä¸ªç³»åˆ—)
```json
{
    "operation": "edit",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "all",
    "title": "æ–°æ ‡é¢˜",
    "content": "æ–°å†…å®¹"
}
```

**æ•ˆæœ**: 
- æ›´æ–°æ‰€æœ‰å®ä¾‹çš„æŒ‡å®šå­—æ®µ
- **ä¸ä¿®æ”¹** trigger_timeï¼ˆä¿æŒåŸæœ‰æ—¶é—´ï¼‰
- é€‚åˆæ‰¹é‡æ›´æ–°æè¿°ã€ä¼˜å…ˆçº§ç­‰

---

#### edit_scope: "from_this" (æ­¤åŠä¹‹å)
```json
{
    "operation": "edit",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "from_this",
    "priority": "low"
}
```

**æ•ˆæœ**: 
- æ›´æ–°è¯¥å®ä¾‹åŠä¹‹åçš„æ‰€æœ‰å®ä¾‹
- ä¹‹å‰çš„å®ä¾‹ä¿æŒä¸å˜
- é€‚åˆé˜¶æ®µæ€§è°ƒæ•´

---

#### edit_scope: "from_time" (ä»æŒ‡å®šæ—¶é—´ + å¯ä¿®æ”¹RRule)
```json
{
    "operation": "edit",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "from_time",
    "from_time": "2025-01-25T10:00:00",
    "rrule": "FREQ=WEEKLY;BYDAY=MO,WE,FR",
    "title": "æ–°è§„åˆ™æé†’"
}
```

**æ•ˆæœ**: 
- **å¦‚æœä¿®æ”¹äº† rrule**: åˆ›å»ºæ–°ç³»åˆ—ï¼Œæˆªæ–­æ—§ç³»åˆ—
- **å¦‚æœæœªä¿®æ”¹ rrule**: ä»…æ›´æ–°å­—æ®µ
- é€‚åˆæ”¹å˜é‡å¤è§„å¾‹

---

### åˆ é™¤æ“ä½œ (operation: "delete")

#### edit_scope: "all" (åˆ é™¤æ•´ä¸ªç³»åˆ—)
```json
{
    "operation": "delete",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "all"
}
```

**æ•ˆæœ**: 
- åˆ é™¤ç³»åˆ—çš„æ‰€æœ‰å®ä¾‹
- ä» RRule å¼•æ“ä¸­åˆ é™¤
- å½»åº•æ¸…é™¤

---

#### edit_scope: "from_this" (åˆ é™¤æ­¤åŠä¹‹å)
```json
{
    "operation": "delete",
    "reminder_id": "reminder-123",
    "series_id": "series-456",
    "edit_scope": "from_this"
}
```

**æ•ˆæœ**: 
- åˆ é™¤è¯¥å®ä¾‹åŠä¹‹åçš„æ‰€æœ‰å®ä¾‹
- ä½¿ç”¨ UNTIL æˆªæ–­ç³»åˆ—
- ä¿ç•™ä¹‹å‰çš„å®ä¾‹

---

## ğŸ” å®ç°ç»†èŠ‚

### RRule ä¿®æ”¹æ£€æµ‹

åç«¯ä¼šè‡ªåŠ¨æ£€æµ‹ RRule æ˜¯å¦çœŸæ­£å‘ç”Ÿå˜åŒ–ï¼š

```python
# è·å–åŸå§‹ RRule
original_rrule = "FREQ=DAILY;INTERVAL=1"

# æ–°çš„ RRule
new_rrule = "FREQ=WEEKLY;BYDAY=MO,WE,FR"

if original_rrule != new_rrule:
    # RRule å‘ç”Ÿå˜åŒ–ï¼šåˆ›å»ºæ–°ç³»åˆ—ï¼Œæˆªæ–­æ—§ç³»åˆ—
    modify_recurring_rule(...)
else:
    # RRule æœªå˜åŒ–ï¼šä»…æ›´æ–°å­—æ®µ
    update_fields(...)
```

### æ—¶é—´ä¿æŠ¤æœºåˆ¶

**é RRule ä¿®æ”¹æ—¶**:
- è‡ªåŠ¨è¿‡æ»¤æ‰ `trigger_time` å­—æ®µ
- ä¿æŒæ‰€æœ‰å®ä¾‹çš„åŸæœ‰è§¦å‘æ—¶é—´
- ä»…æ›´æ–°å…¶ä»–å­—æ®µ

```python
# åç«¯å¤„ç†
update_data = {k: v for k, v in updates.items() if k not in ['rrule', 'trigger_time']}
```

### è¶…æ—¶ä¿æŠ¤

```python
# 35 ç§’è¶…æ—¶
# 25 ç§’è­¦å‘Šè¿”å›
```

---

## âš ï¸  æ³¨æ„äº‹é¡¹

### 1. è·å– ID çš„æ–¹æ³•

æ‰¹é‡ç¼–è¾‘éœ€è¦ `reminder_id` å’Œ `series_id`ï¼Œè·å–æ–¹æ³•ï¼š

```python
# 1. è·å–æé†’åˆ—è¡¨
reminders = example_get_reminders(token)

# 2. æ‰¾åˆ°é‡å¤æé†’
recurring = next(
    (r for r in reminders if r.get('is_recurring')), 
    None
)

# 3. æå– ID
if recurring:
    reminder_id = recurring['id']
    series_id = recurring['series_id']
```

### 2. edit_scope æ˜ å°„

å‰ç«¯å¯èƒ½å‘é€ä¸åŒçš„å€¼ï¼Œåç«¯ä¼šè‡ªåŠ¨æ˜ å°„ï¼š

| å‰ç«¯å‘é€ | åç«¯å¤„ç† |
|---------|---------|
| `this_only` | `single` |
| `all` | `all` |
| `from_this` | `future` |
| `from_time` | `from_time` |

### 3. å­—æ®µåç§°

ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„å­—æ®µåï¼š
- âœ… `content` (ä¸æ˜¯ description)
- âœ… `priority` (ä¸æ˜¯ reminder_type)
- âœ… `trigger_time` (ä¸æ˜¯ reminder_time)

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `docs/å‡çº§ä¸å¼€å‘æ–‡æ¡£/URLè·¯ç”±åŠŸèƒ½è¯´æ˜æ–‡æ¡£.md` - å®Œæ•´çš„ API æ–‡æ¡£
- `docs/å‡çº§ä¸å¼€å‘æ–‡æ¡£/Reminders_APIä¿®å¤è¯´æ˜.md` - å‚æ•°ä¿®å¤è¯´æ˜
- `api_examples/example_reminders_api.py` - æ‰€æœ‰ç¤ºä¾‹ä»£ç 
- `test_bulk_edit_reminders.py` - æ‰¹é‡ç¼–è¾‘æµ‹è¯•è„šæœ¬
- `core/views_reminder.py` - åç«¯å®ç°ä»£ç 

---

## ğŸ‰ æ€»ç»“

æ­¤æ¬¡æ›´æ–°ä¸º Reminders API è¡¥å……äº†å®Œæ•´çš„æ‰¹é‡ç¼–è¾‘ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ï¼š

âœ… 6 ä¸ªæ‰¹é‡ç¼–è¾‘ç¤ºä¾‹å‡½æ•°  
âœ… 1 ä¸ªç»¼åˆæ¼”ç¤ºç¤ºä¾‹  
âœ… 1 ä¸ªå®Œæ•´çš„æµ‹è¯•è„šæœ¬  
âœ… è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜  

å¼€å‘è€…ç°åœ¨å¯ä»¥å‚è€ƒè¿™äº›ç¤ºä¾‹ï¼Œæ­£ç¡®ä½¿ç”¨æ‰¹é‡ç¼–è¾‘åŠŸèƒ½æ¥ç®¡ç†é‡å¤æé†’ã€‚

---

**æ›´æ–°å®Œæˆæ—¥æœŸ**: 2025-01-XX  
**æ›´æ–°äººå‘˜**: AI Assistant  
**å®¡æ ¸çŠ¶æ€**: å¾…å®¡æ ¸
