# æœ€ç»ˆä¿®å¤æ–¹æ¡ˆ - 2025å¹´11æœˆ4æ—¥

## ä¿®å¤çš„é—®é¢˜

### âœ… é—®é¢˜1: "ä»Šå¤©"èƒŒæ™¯æ¶ˆå¤± - å·²è§£å†³
é€šè¿‡ä¿®æ”¹CSSé€‰æ‹©å™¨ï¼Œä½¿ç”¨ `:not(.fc-day-today)` æ’é™¤"ä»Šå¤©"å…ƒç´ ã€‚

### ğŸ”§ é—®é¢˜2: é¡µé¢é¡¶éƒ¨"ç¬¬Nå‘¨"å¾½ç« ä¸è·Ÿéšä¸»é¢˜å˜åŒ– - å·²ä¿®å¤

**é—®é¢˜åˆ†æ**ï¼š
ç”¨æˆ·æŒ‡çš„æ˜¯é¡µé¢é¡¶éƒ¨æ—¥å†æ ‡é¢˜æ—è¾¹çš„è¿™ä¸ªå…ƒç´ ï¼š
```html
<span id="weekNumberBadge" class="badge bg-primary ms-3" 
      style="font-size: 0.9rem; vertical-align: middle;">
    ç¬¬ 9-14 å‘¨ (2025å­¦å¹´ç§‹å­£å­¦æœŸ)
</span>
```

è¿™ä¸ªå¾½ç« ä½¿ç”¨äº†Bootstrapçš„å›ºå®šç±» `bg-primary`ï¼ˆè“è‰²èƒŒæ™¯ï¼‰ï¼Œä¸ä¼šè·Ÿéšä¸»é¢˜å˜åŒ–ã€‚

**ä¿®å¤æ–¹æ¡ˆ**ï¼š

1. **CSSä¿®æ”¹** (core/static/css/home-styles.css ç¬¬3130è¡Œ)ï¼š
```css
/* å‘¨æ•°å¾½ç« ä¸»é¢˜é€‚é… */
#weekNumberBadge {
    background-color: var(--primary) !important;
    color: var(--text-inverse) !important;
    border: 1px solid var(--primary) !important;
}
```

2. **HTMLä¿®æ”¹** (core/templates/home_new.html ç¬¬2773è¡Œ)ï¼š
```javascript
// ä¿®æ”¹å‰
weekBadge.className = 'badge bg-primary ms-3';

// ä¿®æ”¹å
weekBadge.className = 'badge ms-3';  // ç§»é™¤bg-primaryï¼Œæ”¹ç”¨CSSä¸»é¢˜é€‚é…
```

**æ•ˆæœ**ï¼š
- å¾½ç« çš„èƒŒæ™¯è‰²ç°åœ¨ä½¿ç”¨ `var(--primary)` ä¸»é¢˜å˜é‡
- ä¸åŒä¸»é¢˜çš„å¾½ç« é¢œè‰²ï¼š
  - light ä¸»é¢˜ï¼šè“è‰² (#0d6efd)
  - dark ä¸»é¢˜ï¼šæµ…è“è‰² (#4d9fff)
  - china-red ä¸»é¢˜ï¼šä¸­å›½çº¢ (#de2910)
  - warm-pastel ä¸»é¢˜ï¼šç²‰è‰² (#ff9eb6)
  - cool-pastel ä¸»é¢˜ï¼šé’è‰² (#45d5ac)
  - ç­‰ç­‰...

### ğŸ”§ é—®é¢˜3: æœˆè§†å›¾æ— æ³•æ»šåŠ¨ - å·²ä¿®å¤

**é—®é¢˜åˆ†æ**ï¼š
ä¹‹å‰çš„CSSè§„åˆ™å­˜åœ¨å…¨å±€å†²çªï¼š
```css
/* é—®é¢˜ä»£ç  - 1823è¡Œ */
.fc-view-harness {
    overflow: hidden !important;  /* âŒ å…¨å±€ç¦ç”¨æ‰€æœ‰è§†å›¾çš„æ»šåŠ¨ */
}
```

è¿™ä¸ªå…¨å±€è§„åˆ™è¦†ç›–äº†æœˆè§†å›¾çš„æ»šåŠ¨è®¾ç½®ã€‚

**ä¿®å¤æ–¹æ¡ˆ** (core/static/css/home-styles.css ç¬¬1820-1860è¡Œ)ï¼š

```css
/* é»˜è®¤ç¦ç”¨view-harnessæ»šåŠ¨ï¼Œå‘¨è§†å›¾å’Œæ—¥è§†å›¾ä¸éœ€è¦ */
.fc-timeGridWeek-view .fc-view-harness,
.fc-timeGridDay-view .fc-view-harness,
.fc-timeGrid-view .fc-view-harness {
    overflow: hidden !important;
}

/* æœˆè§†å›¾view-harnesså…è®¸æ»šåŠ¨ */
.fc-dayGridMonth-view .fc-view-harness {
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* æœˆè§†å›¾å¯ç”¨æ»šåŠ¨ - ä½¿ç”¨å¤šä¸ªé€‰æ‹©å™¨ç¡®ä¿ç”Ÿæ•ˆ */
.fc-dayGridMonth-view .fc-scroller,
.fc-dayGridMonth-view .fc-daygrid-body,
.fc-dayGridMonth-view .fc-scroller-liquid,
.fc-dayGridMonth-view .fc-scroller-harness {
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* æœˆè§†å›¾çš„daygrid-bodyå¯ç”¨æ»šåŠ¨ */
.fc-dayGridMonth-view .fc-daygrid-body {
    overflow: auto !important;
}
```

**å…³é”®æ”¹è¿›**ï¼š
1. **ç§»é™¤å…¨å±€ `.fc-view-harness` è§„åˆ™**ï¼Œæ”¹ä¸ºé’ˆå¯¹ç‰¹å®šè§†å›¾
2. **ä¸ºæœˆè§†å›¾æ·»åŠ å¤šä¸ªé€‰æ‹©å™¨**ï¼Œè¦†ç›–æ‰€æœ‰å¯èƒ½çš„æ»šåŠ¨å®¹å™¨
3. **ä½¿ç”¨ `.fc-dayGridMonth-view` å‰ç¼€**ç¡®ä¿åªå½±å“æœˆè§†å›¾

### ğŸ é¢å¤–åŠŸèƒ½ï¼šå¯ç”¨FullCalendarå†…éƒ¨å‘¨æ•°æ˜¾ç¤º

**ä¿®æ”¹** (core/static/js/event-manager.js ç¬¬52è¡Œ)ï¼š
```javascript
this.calendar = new FullCalendar.Calendar(calendarEl, {
    // ... å…¶ä»–é…ç½® ...
    weekNumbers: true, // å¯ç”¨å‘¨æ•°æ˜¾ç¤ºï¼ˆåœ¨æœˆè§†å›¾å·¦ä¾§æ˜¾ç¤ºå‘¨æ•°ï¼‰
    // ... å…¶ä»–é…ç½® ...
});
```

**æ•ˆæœ**ï¼š
- æœˆè§†å›¾å·¦ä¾§ä¼šæ˜¾ç¤ºISOå‘¨æ•°ï¼ˆå¦‚ W1, W2, W3...ï¼‰
- å‘¨æ•°ä½¿ç”¨ä¹‹å‰å·²é…ç½®çš„ä¸»é¢˜é¢œè‰²ï¼ˆ`--bg-tertiary` å’Œ `--text-secondary`ï¼‰

---

## å®Œæ•´ä¿®æ”¹æ¸…å•

### 1. core/static/css/home-styles.css

#### ä¿®æ”¹ä½ç½®1: ç¬¬1820-1860è¡Œ - æœˆè§†å›¾æ»šåŠ¨ä¿®å¤
```css
/* é»˜è®¤ç¦ç”¨view-harnessæ»šåŠ¨ï¼Œå‘¨è§†å›¾å’Œæ—¥è§†å›¾ä¸éœ€è¦ */
.fc-timeGridWeek-view .fc-view-harness,
.fc-timeGridDay-view .fc-view-harness,
.fc-timeGrid-view .fc-view-harness {
    overflow: hidden !important;
}

/* æœˆè§†å›¾view-harnesså…è®¸æ»šåŠ¨ */
.fc-dayGridMonth-view .fc-view-harness {
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

/* æœˆè§†å›¾å¯ç”¨æ»šåŠ¨ - ä½¿ç”¨å¤šä¸ªé€‰æ‹©å™¨ç¡®ä¿ç”Ÿæ•ˆ */
.fc-dayGridMonth-view .fc-scroller,
.fc-dayGridMonth-view .fc-daygrid-body,
.fc-dayGridMonth-view .fc-scroller-liquid,
.fc-dayGridMonth-view .fc-scroller-harness {
    overflow-y: auto !important;
    overflow-x: hidden !important;
}

.fc-daygrid-body {
    overflow: hidden !important;
}

/* æœˆè§†å›¾çš„daygrid-bodyå¯ç”¨æ»šåŠ¨ */
.fc-dayGridMonth-view .fc-daygrid-body {
    overflow: auto !important;
}
```

#### ä¿®æ”¹ä½ç½®2: ç¬¬3130è¡Œ - å‘¨æ•°å¾½ç« ä¸»é¢˜é€‚é…
```css
/* å‘¨æ•°å¾½ç« ä¸»é¢˜é€‚é… */
#weekNumberBadge {
    background-color: var(--primary) !important;
    color: var(--text-inverse) !important;
    border: 1px solid var(--primary) !important;
}
```

### 2. core/templates/home_new.html

#### ä¿®æ”¹ä½ç½®: ç¬¬2773è¡Œ - ç§»é™¤å›ºå®šçš„bg-primaryç±»
```javascript
// ä¿®æ”¹å‰
weekBadge.className = 'badge bg-primary ms-3';

// ä¿®æ”¹å
weekBadge.className = 'badge ms-3';  // ç§»é™¤bg-primaryï¼Œæ”¹ç”¨CSSä¸»é¢˜é€‚é…
```

### 3. core/static/js/event-manager.js

#### ä¿®æ”¹ä½ç½®: ç¬¬52è¡Œ - å¯ç”¨å‘¨æ•°æ˜¾ç¤º
```javascript
weekNumbers: true, // å¯ç”¨å‘¨æ•°æ˜¾ç¤ºï¼ˆåœ¨æœˆè§†å›¾å·¦ä¾§æ˜¾ç¤ºå‘¨æ•°ï¼‰
```

---

## æµ‹è¯•éªŒè¯

### 1. é¡µé¢é¡¶éƒ¨å‘¨æ•°å¾½ç« æµ‹è¯•
1. åˆ·æ–°é¡µé¢ï¼ˆCtrl + F5ï¼‰
2. è§‚å¯Ÿé¡µé¢é¡¶éƒ¨æ—¥å†æ ‡é¢˜æ—è¾¹çš„"ç¬¬Nå‘¨"å¾½ç« 
3. åˆ‡æ¢ä¸åŒä¸»é¢˜ï¼ˆå³ä¸Šè§’ä¸»é¢˜åˆ‡æ¢æŒ‰é’®ï¼‰
4. **é¢„æœŸç»“æœ**ï¼šå¾½ç« é¢œè‰²åº”è¯¥è·Ÿéšä¸»é¢˜å˜åŒ–
   - light: è“è‰²
   - dark: æµ…è“è‰²
   - china-red: çº¢è‰²
   - warm-pastel: ç²‰è‰²
   - ç­‰ç­‰...

### 2. æœˆè§†å›¾æ»šåŠ¨æµ‹è¯•
1. åˆ‡æ¢åˆ°æœˆè§†å›¾
2. æ·»åŠ å¤šä¸ªäº‹ä»¶ï¼ˆè®©å†…å®¹è¶…å‡ºè§†å£é«˜åº¦ï¼‰
3. ä½¿ç”¨é¼ æ ‡æ»šè½®ä¸Šä¸‹æ»šåŠ¨
4. **é¢„æœŸç»“æœ**ï¼šæ—¥å†åº”è¯¥å¯ä»¥å¹³æ»‘æ»šåŠ¨

### 3. FullCalendarå†…éƒ¨å‘¨æ•°æµ‹è¯•
1. åˆ‡æ¢åˆ°æœˆè§†å›¾
2. è§‚å¯Ÿæ—¥å†å·¦ä¾§
3. **é¢„æœŸç»“æœ**ï¼šåº”è¯¥æ˜¾ç¤ºå‘¨æ•°ï¼ˆå¦‚ W1, W2, W3...ï¼‰
4. åˆ‡æ¢ä¸»é¢˜ï¼Œå‘¨æ•°é¢œè‰²åº”è¯¥è·Ÿéšå˜åŒ–

### 4. "ä»Šå¤©"èƒŒæ™¯æµ‹è¯•
1. åœ¨æœˆè§†å›¾ã€å‘¨è§†å›¾ã€åˆ—è¡¨è§†å›¾ä¸­æŸ¥çœ‹ä»Šå¤©çš„æ—¥æœŸ
2. åˆ‡æ¢ä¸åŒä¸»é¢˜
3. **é¢„æœŸç»“æœ**ï¼šä»Šå¤©åº”è¯¥æœ‰æ˜æ˜¾çš„æµ…è‰²èƒŒæ™¯é«˜äº®

---

## æŠ€æœ¯è¦ç‚¹æ€»ç»“

### CSSé€‰æ‹©å™¨ä¼˜å…ˆçº§ç­–ç•¥
1. **é¿å…è¿‡äºå®½æ³›çš„å…¨å±€è§„åˆ™**
   - âŒ `.fc-view-harness { overflow: hidden !important; }`
   - âœ… `.fc-timeGridWeek-view .fc-view-harness { overflow: hidden !important; }`

2. **ä½¿ç”¨å…·ä½“çš„è§†å›¾å‰ç¼€**
   - `.fc-dayGridMonth-view` - æœˆè§†å›¾
   - `.fc-timeGridWeek-view` - å‘¨è§†å›¾
   - `.fc-timeGridDay-view` - æ—¥è§†å›¾
   - `.fc-listWeek-view` - åˆ—è¡¨è§†å›¾

3. **ä½¿ç”¨å¤šä¸ªé€‰æ‹©å™¨è¦†ç›–æ‰€æœ‰å¯èƒ½çš„å…ƒç´ **
   ```css
   .fc-dayGridMonth-view .fc-scroller,
   .fc-dayGridMonth-view .fc-daygrid-body,
   .fc-dayGridMonth-view .fc-scroller-liquid,
   .fc-dayGridMonth-view .fc-scroller-harness {
       overflow-y: auto !important;
   }
   ```

### ä¸»é¢˜å˜é‡ä½¿ç”¨
- `var(--primary)` - ä¸»è‰²è°ƒ
- `var(--text-inverse)` - åè‰²æ–‡å­—ï¼ˆç”¨äºæ·±è‰²èƒŒæ™¯ï¼‰
- `var(--bg-tertiary)` - ç¬¬ä¸‰çº§èƒŒæ™¯è‰²
- `var(--text-secondary)` - æ¬¡è¦æ–‡å­—é¢œè‰²

### DOMæ“ä½œæœ€ä½³å®è·µ
1. **ä½¿ç”¨IDé€‰æ‹©å™¨æ§åˆ¶ç‰¹å®šå…ƒç´ æ ·å¼**
   ```css
   #weekNumberBadge {
       background-color: var(--primary) !important;
   }
   ```

2. **é€šè¿‡ç§»é™¤å›ºå®šç±»æ¥å¯ç”¨CSSä¸»é¢˜é€‚é…**
   ```javascript
   // ä¸å¥½ï¼šä½¿ç”¨å›ºå®šçš„Bootstrapç±»
   element.className = 'badge bg-primary';
   
   // å¥½ï¼šç§»é™¤å›ºå®šç±»ï¼Œé€šè¿‡CSS IDé€‰æ‹©å™¨åº”ç”¨ä¸»é¢˜æ ·å¼
   element.className = 'badge';
   element.id = 'weekNumberBadge';
   ```

---

## å¯èƒ½çš„é—®é¢˜æ’æŸ¥

### å¦‚æœæœˆè§†å›¾ä»ç„¶æ— æ³•æ»šåŠ¨

1. **æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·**ï¼ˆF12ï¼‰
   - Elementsæ ‡ç­¾ â†’ é€‰æ‹©æœˆè§†å›¾çš„å®¹å™¨å…ƒç´ 
   - Computedæ ‡ç­¾ â†’ æŸ¥çœ‹ `overflow-y` çš„æœ€ç»ˆè®¡ç®—å€¼
   - åº”è¯¥æ˜¾ç¤º `auto`ï¼Œè€Œä¸æ˜¯ `hidden`

2. **æ£€æŸ¥CSSè§„åˆ™æ˜¯å¦ç”Ÿæ•ˆ**
   ```javascript
   // åœ¨Consoleä¸­æ‰§è¡Œ
   const monthView = document.querySelector('.fc-dayGridMonth-view');
   const scroller = monthView?.querySelector('.fc-scroller');
   console.log('overflow-y:', getComputedStyle(scroller).overflowY);
   // åº”è¯¥è¾“å‡º "auto"
   ```

3. **æ£€æŸ¥æ˜¯å¦æœ‰JavaScriptåŠ¨æ€ä¿®æ”¹æ ·å¼**
   - æœç´¢ `forceScrollable` æ–¹æ³•
   - è¿™ä¸ªæ–¹æ³•å¯èƒ½åœ¨è§†å›¾åˆ‡æ¢æ—¶é‡æ–°åº”ç”¨æ»šåŠ¨è®¾ç½®

### å¦‚æœå‘¨æ•°å¾½ç« é¢œè‰²ä¸å˜

1. **æ£€æŸ¥CSSå˜é‡å€¼**
   ```javascript
   // åœ¨Consoleä¸­æ‰§è¡Œ
   getComputedStyle(document.documentElement).getPropertyValue('--primary')
   // åº”è¯¥è¿”å›å½“å‰ä¸»é¢˜çš„ä¸»è‰²è°ƒï¼Œå¦‚ "#0d6efd"
   ```

2. **æ£€æŸ¥å…ƒç´ çš„å®é™…æ ·å¼**
   ```javascript
   const badge = document.getElementById('weekNumberBadge');
   console.log('background:', getComputedStyle(badge).backgroundColor);
   // åº”è¯¥æ˜¯ä¸»é¢˜è‰²ï¼Œè€Œä¸æ˜¯å›ºå®šçš„è“è‰²
   ```

3. **å¼ºåˆ¶åˆ·æ–°ç¼“å­˜**
   - Ctrl + F5 (Windows)
   - Cmd + Shift + R (Mac)
   - æˆ–è€…æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

---

## åç»­ä¼˜åŒ–å»ºè®®

1. **ç»Ÿä¸€å‘¨æ•°æ˜¾ç¤ºé€»è¾‘**
   - ç›®å‰æœ‰ä¸¤ç§å‘¨æ•°æ˜¾ç¤ºï¼š
     - é¡µé¢é¡¶éƒ¨å¾½ç« ï¼ˆè‡ªå®šä¹‰å­¦æœŸå‘¨æ•°ï¼‰
     - FullCalendarå†…éƒ¨å‘¨æ•°ï¼ˆISOå‘¨æ•°ï¼‰
   - å¯ä»¥è€ƒè™‘åªä¿ç•™ä¸€ç§ï¼Œé¿å…æ··æ·†

2. **æ·»åŠ é…ç½®é€‰é¡¹**
   - å…è®¸ç”¨æˆ·åœ¨è®¾ç½®ä¸­é€‰æ‹©æ˜¯å¦æ˜¾ç¤ºFullCalendarå†…éƒ¨å‘¨æ•°
   - å…è®¸ç”¨æˆ·é€‰æ‹©å‘¨æ•°è®¡ç®—æ–¹å¼ï¼ˆISOæ ‡å‡† vs å­¦æœŸå‘¨æ•°ï¼‰

3. **æ”¹è¿›CSSç»„ç»‡**
   - å°†ä¸»é¢˜ç›¸å…³çš„CSSé›†ä¸­åˆ°ä¸€ä¸ªåŒºåŸŸ
   - ä½¿ç”¨CSSè‡ªå®šä¹‰å±æ€§ï¼ˆå˜é‡ï¼‰ç»Ÿä¸€ç®¡ç†é¢œè‰²

4. **æ·»åŠ è¿‡æ¸¡åŠ¨ç”»**
   ```css
   #weekNumberBadge {
       background-color: var(--primary) !important;
       color: var(--text-inverse) !important;
       border: 1px solid var(--primary) !important;
       transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
   }
   ```

---

## ä¿®å¤æ•ˆæœé¢„è§ˆ

### ä¸»é¢˜åˆ‡æ¢æ•ˆæœ
| ä¸»é¢˜ | å‘¨æ•°å¾½ç« é¢œè‰² | "ä»Šå¤©"èƒŒæ™¯è‰² | FullCalendarå‘¨æ•°é¢œè‰² |
|------|------------|-------------|-------------------|
| light | è“è‰² (#0d6efd) | æµ…é»„è‰² (rgba(255, 220, 40, 0.15)) | ç°è‰²èƒŒæ™¯ |
| dark | æµ…è“è‰² (#4d9fff) | æ·±é»„è‰² (rgba(251, 188, 4, 0.1)) | æ·±ç°èƒŒæ™¯ |
| china-red | ä¸­å›½çº¢ (#de2910) | æµ…é»„è‰² (rgba(255, 222, 0, 0.2)) | ç°è‰²èƒŒæ™¯ |
| warm-pastel | ç²‰è‰² (#ff9eb6) | æµ…æ©™è‰² (rgba(255, 214, 153, 0.25)) | æµ…ç°èƒŒæ™¯ |
| cyberpunk | é’è‰² (#00e5ff) | é»„ç»¿è‰² (rgba(255, 214, 0, 0.15)) | æ·±ç°èƒŒæ™¯ |

### æ»šåŠ¨è¡Œä¸º
- **æœˆè§†å›¾**ï¼šâœ… å¯æ»šåŠ¨ï¼ˆå½“äº‹ä»¶è¶…å‡ºè§†å£æ—¶ï¼‰
- **å‘¨è§†å›¾**ï¼šâŒ ä¸æ»šåŠ¨ï¼ˆä¿æŒå›ºå®šå¸ƒå±€ï¼‰
- **æ—¥è§†å›¾**ï¼šâŒ ä¸æ»šåŠ¨ï¼ˆä¿æŒå›ºå®šå¸ƒå±€ï¼‰
- **åˆ—è¡¨è§†å›¾**ï¼šâœ… å¯æ»šåŠ¨
