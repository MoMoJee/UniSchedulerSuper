# 网站备案信息配置说明

## 概述

本项目支持在网站底部显示ICP备案号等合规信息。备案信息通过独立的配置文件管理，支持可选配置（未配置时不显示）。

## 配置文件

### 文件位置
- 配置文件：`config/beian.json`（已加入.gitignore，不会被提交到Git）
- 示例文件：`config/beian.example.json`（可以提交到Git作为参考）

### 配置格式

```json
{
  "enabled": true,
  "icp_number": "浙ICP备2025213755号-1",
  "icp_link": "https://beian.miit.gov.cn",
  "gongan_number": "",
  "gongan_link": "",
  "display_text": ""
}
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| `enabled` | boolean | 是 | 是否启用备案信息显示。设为`false`则不显示任何备案信息 |
| `icp_number` | string | 否 | ICP备案号，如"浙ICP备2025213755号-1" |
| `icp_link` | string | 否 | ICP备案查询链接，默认为工信部备案查询网站 |
| `gongan_number` | string | 否 | 公安备案号（可选） |
| `gongan_link` | string | 否 | 公安备案查询链接（可选） |
| `display_text` | string | 否 | 自定义显示文本（如果设置，将覆盖自动生成的备案信息） |

## 使用场景

### 场景1：有ICP备案（推荐）

如果你的网站已经完成ICP备案，请配置如下：

```json
{
  "enabled": true,
  "icp_number": "浙ICP备2025213755号-1",
  "icp_link": "https://beian.miit.gov.cn"
}
```

### 场景2：无备案信息（开源项目使用者）

如果你只是本地使用或没有备案，请配置如下：

```json
{
  "enabled": false
}
```

或者直接删除 `config/beian.json` 文件，系统会自动使用默认配置（不显示）。

### 场景3：有公安备案

如果同时有ICP备案和公安备案：

```json
{
  "enabled": true,
  "icp_number": "浙ICP备2025213755号-1",
  "icp_link": "https://beian.miit.gov.cn",
  "gongan_number": "京公网安备 11010502012345号",
  "gongan_link": "http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502012345"
}
```

## 初始配置步骤

1. **复制示例文件**
   ```bash
   cp config/beian.example.json config/beian.json
   ```

2. **编辑配置文件**
   - 打开 `config/beian.json`
   - 如果有备案：将 `enabled` 设为 `true`，填入你的备案号
   - 如果没有备案：将 `enabled` 设为 `false`

3. **保存并重启服务**
   - 保存配置文件
   - 重启Django服务，备案信息即可生效

## 显示效果

备案信息会显示在以下页面的底部：
- 首页（`/`）
- 登录页（`/user_login`）
- 主页（`/home`）

显示样式：
- 居中对齐
- 灰色小字
- 点击可跳转到工信部备案查询网站
- 支持深色模式自适应

## 法律合规说明

根据《互联网信息服务管理办法》和《非经营性互联网信息服务备案管理办法》的规定：

1. **境内网站必须备案**：在中国境内提供互联网信息服务的网站必须进行ICP备案
2. **备案号展示要求**：备案通过后，应在网站首页底部显著位置标明其备案编号
3. **超链接要求**：备案编号应当链接至工信部备案管理系统网站（https://beian.miit.gov.cn）

**注意**：
- 如果你的网站仅在本地使用或用于开发测试，不对外提供服务，则无需备案
- 如果你的网站部署在境外服务器，则不需要ICP备案（但需遵守当地法律）
- 如果你需要备案，请访问 https://beian.miit.gov.cn 进行办理

## 技术实现

### 配置管理模块
- `config/beian_manager.py`：备案信息读取和管理
  - `get_beian_info()`：读取配置文件
  - `format_beian_html()`：格式化HTML输出

### 视图函数修改
修改了以下视图函数，传递备案信息到模板：
- `core/views.py::index()`
- `core/views.py::user_login()`
- `core/views.py::home()`

### 模板修改
在以下模板底部添加了备案信息显示：
- `core/templates/index.html`
- `core/templates/user_login.html`
- `core/templates/home.html`

## 常见问题

### Q: 配置文件不存在会怎样？
A: 系统会自动使用默认配置（不显示备案信息），不会报错。

### Q: 修改配置后需要重启服务吗？
A: 是的，Django会在启动时读取配置文件，修改后需要重启服务才能生效。

### Q: 为什么配置文件要加入.gitignore？
A: 为了保护隐私和支持多环境部署。不同的开发者或部署环境可能有不同的备案信息，通过.gitignore可以避免配置冲突。

### Q: 可以自定义显示样式吗？
A: 可以。通过修改 `display_text` 字段可以自定义显示内容。如果需要更复杂的样式，可以直接修改模板文件。

## 更新记录

- 2026-02-03: 初始版本，支持ICP备案和公安备案信息配置和显示
